<!-- templates/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <!-- … your head as before, but loading bootstrap locally … -->
  <link rel="stylesheet"
        href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
</head>
<body class="bg-light">
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <!-- … -->
  </nav>

  <div class="container my-4">
    <!-- ==== New: Post form with toggle buttons ==== -->
    <h2 class="mb-3">Submit a Post</h2>
    <form id="post-form">
      <div class="mb-3">
        <!-- Bootstrap 5 “button‐check” toggles -->
        <div class="btn-group" role="group" aria-label="Category">
          <input type="radio" class="btn-check" name="category" id="cat-academic"
                 value="Academic Help" autocomplete="off" checked>
          <label class="btn btn-outline-primary" for="cat-academic">
            Academic Help
          </label>

          <input type="radio" class="btn-check" name="category" id="cat-lostfound"
                 value="Lost &amp; Found" autocomplete="off">
          <label class="btn btn-outline-primary" for="cat-lostfound">
            Lost &amp; Found
          </label>

          <input type="radio" class="btn-check" name="category" id="cat-interest"
                 value="Interest Group" autocomplete="off">
          <label class="btn btn-outline-primary" for="cat-interest">
            Interest Group
          </label>

          <input type="radio" class="btn-check" name="category" id="cat-announcement"
                 value="Announcement" autocomplete="off">
          <label class="btn btn-outline-primary" for="cat-announcement">
            Announcement
          </label>
        </div>
      </div>

      <div class="mb-3">
        <textarea class="form-control"
                  id="post-content"
                  rows="3"
                  placeholder="Enter your message…"></textarea>
      </div>

      <button type="submit" class="btn btn-primary">Send</button>
    </form>

    <!-- ==== Your existing “All Posts” list ==== -->
    <h2 class="mt-5 mb-3">All Posts</h2>
    <div id="posts" class="row row-cols-1 row-cols-md-2 g-4">
      {% if posts %} … {% endif %}
    </div>
  </div>

  <!-- local JS assets -->
  <script src="{{ url_for('static', filename='js/bootstrap.bundle.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/socket.io.min.js') }}"></script>

  <script>
    // Socket.IO for live updates (unchanged)…
    const socket = io();
    socket.on('new_post', p => { /* … */ });

    // New: handle our form submit
    document
      .getElementById('post-form')
      .addEventListener('submit', async e => {
        e.preventDefault();
        const category = document.querySelector('input[name="category"]:checked').value;
        const content  = document.getElementById('post-content').value.trim();
        if (!content) {
          return alert('Please enter some content!');
        }
        try {
          const res = await fetch('/api/posts', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ category, content })
          });
          if (!res.ok) throw new Error(res.statusText);
          document.getElementById('post-content').value = '';
        } catch (err) {
          alert('Failed to send post: ' + err.message);
        }
      });
  </script>
</body>
</html>
